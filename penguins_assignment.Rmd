---
title: "penguins_assignment"
candidate ID: '1053835'
date: "2022-12-04"
output:
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Question 1: What is the reproducibility crisis in science and why should we care? (300-500 words).

###### The reproducibility crisis refers to a growing problem in the scientific community wherein scientists are struggling to regenerate the results of an original study using exactly the same data and methods as that study. Some data suggesting that there is a reproducibility crisis comes from the results of a survey by Nature in 2016 (Baker, 2016)^[Baker, M. (2016) "1,500 scientists lift the lid on reproducibility". Nature. Available at: https://www.nature.com/articles/533452a (Accessed: 27 November 2022).]. Of the 1,576 scientists who responded to the survey, more than 70% said that they had been unable to reproduce an experiment by another researcher. Furthermore, 52% of the researchers thought that there is a significant crisis in reproducibility.  These results suggest that most scientists acknowledge that there is a problem with the reproducibility of published research. A reasonable question to ask would be why reproducibility is sought after in the first place? 
###### The purpose of testing for the reproducibility of an experiment is to show that the results obtained by a study aren’t an artefact of the unique lab set-up and conditions used by that study. If the same results can be reproduced in a different environment but using the same data and methods, then this helps to rule out the influence of the experimental conditions on the results. Testing for reproducibility therefore helps to improve confidence in the data and methods used by the original authors of a study. 
###### Ensuring that research is reproducible is not only beneficial to the credibility of research findings, but also makes sense if researchers wish to be pragmatic. This is because scientists often find that they must repeat their studies, for instance, if they found surprising or unexpected results the first time around. They may also need to generate another set of results for further analysis. Having a clear outline of the experimental procedure makes it much easier for researchers to repeat their studies. Furthermore, some journals and editors now require researchers to provide supplementary details for their methods, such as any code used in their analyses, for their paper to be published. If a researcher has been meticulous about outlining the methods used to generate their research outputs, then they will find it much easier to get their paper published.
###### A final reason why scientists should care about the reproducibility of their studies is because being clear about the data and methods used for an experiment helps to contribute to “open research” (McKiernan et al., 2016)^[McKiernan, E. et al. (2016) "How open science helps researchers succeed", eLife, 5. doi: 10.7554/elife.16800.]. Open research involves making data publicly available, being transparent about methods and sources used, and using appropriate licenses to outline clearly how the work should be reused. Striving to make science more open is beneficial to both researchers and the public. It means that ordinary people can check the reliability and validity of experimental results for themselves by reviewing the approach taken by a study’s authors. Additionally, open research facilitates collaboration between researchers by making their work more visible in the scientific community. This means that researchers with similar interests will be more likely to reach out to one another, potentially leading to successful research partnerships being formed.

\newpage

## Question 2: Create a figure using the *Palmer Penguin* dataset that is correct but badly communicates the data. Focus on visual elements rather than writing misleading text on it. Provide the figure and explain your choices (100-200 words).
```{r Question 2, echo = FALSE, message = FALSE, warning = FALSE, results = 'hide'}
#Setting working directory
setwd("~/PenguinProjectAssignment")

#Loading packages using libraries function
source("functions/libraries.R")

#Loading the raw data
penguins_raw <- read.csv("data_raw/penguins_raw.csv")

#Looking at the raw data
head(penguins_raw)

#Sourcing cleaning function to clean the raw data
source("functions/cleaning.R")

#Cleaning the raw data
penguins_clean <- cleaning(penguins_raw)

#Looking at the clean data
head(penguins_clean)

#Saving the clean data
write.csv(penguins_clean, "data_clean/penguins_clean_1.csv")

#Reading in the clean data
penguins_now_clean <- read.csv("data_clean/penguins_clean_1.csv")

#Sourcing function for making scatter plot
source("functions/make_scatter_plot.r")

#Creating figure called 'scatter_plot'
scatter_plot <- make_scatter_plot(penguins_now_clean)

#Viewing figure
scatter_plot
```
One of the reasons why this figure badly communicates the data is that the axes are not an appropriate scale; the data points are clustered closely together and only occupy a small portion of the space in the scatter plot. Moreover, the gridlines are quite spaced apart. This makes it difficult to determine exactly what the body mass and flipper lengths are for each observation. Additionally, similar colours have been used to represent the data points. This could lead to confusion when trying to identify which observations belong to each species. The fact that all of the data points are the same shape also makes it difficult to distinguish between them. Furthermore, many of the observations are obscured from view because the points are solidly filled and overlap with each other. This means that some of the data is hidden. And finally, units aren’t provided for the axes, so the reader just has to assume what these units are.

\newpage

## Question 3: Discuss how colour choice is important for communication in science figures and what considerations should be made (300-500 words).
###### Colour is a key component of the information that is conveyed by many scientific figures. For instance, colour can be used in heat maps to show how measurements such as temperature vary over different regions. Additionally, colour may be used in scatterplots to categorise observations that into discrete groups, such as different species. In this case, a legend would indicate which colour represents each species, and this would allow readers to identify the species that each data point belongs to. Hence, colour can be used in different types of figures to enhance the interpretation of the data.
###### Given the importance of colour for communicating scientific ideas, it may therefore seem surprising that many researchers don’t use appropriate colour gradients when designing their figures (Crameri et al., 2020)^[Crameri, F., Shephard, G. and Heron, P. (2020) "The misuse of colour in science communication", Nature Communications, 11(1). doi: 10.1038/s41467-020-19160-7.]. For instance, many scientists choose a rainbow colour palette for their figures. One of the problems with using a rainbow colour palette is that it is non-uniform. This means that transitions between certain colours are more dominant. A consequence of this is that data can be misrepresented, for instance by making it appear as though there is a sharper boundary between two parts of a colour map than there actually is. Distorting data in this way could potentially have serious implications, such as when portraying danger zones relating to natural disaster risks. Hence, its recommended that scientists avoid using uneven colour gradients in their figures, so that their data can be interpreted more accurately.
###### Another problem with using the rainbow colour palette is that it makes figures difficult to read for people with colour-vision deficiencies (CVDs) (Katsnelson, 2021)^[Katsnelson, A. (2021) "Colour me better: fixing figures for colour blindness", Nature.com. Available at: https://www.nature.com/articles/d41586-021-02696-z (Accessed: 28 November 2022).]. For instance, people with deuteranomaly find it difficult to distinguish between red and green. These colours are dominant when rainbow colour gradients are applied to figures, so colour maps with a rainbow palette tend to be unreadable to people with this CVD. This is another reason why scientists should avoid using unsuitable colour palettes such as rainbow, as it makes their data inaccessible to people with CVDs.
###### Scientists can resolve these issues by choosing uniform colour palettes instead of non-uniform ones for their figures. Uniform colour palettes have been designed to ensure that variation in the data is represented accurately, rather than being distorted by certain colours. This ensures that readers can gain an intuitive understanding of the data, rather than being misled by colours that appear more pronounced. Furthermore, uniform colour palettes are more suitable for people with CVDs, making the data more accessible.
###### In summary, colour is a key aspect of the information that is conveyed by scientific figures, yet its importance is often overlooked. Many scientists continue to use non-uniform colour gradients such as the rainbow palette when designing their figures, yet these uneven gradients risk distorting the data. Moreover, people with CVDs often find it difficult to read these figures. Instead, scientists should use uniform colour gradients for their figures, which would help to represent their data more accurately and make their findings more accessible to people with CVDs.

\newpage

## Question 4: Run a statistical test on the Palmer Penguins dataset and produce a figure to explain it.
```{r Question 4 Cleaning data, echo = FALSE, message = FALSE, warning = FALSE, results = 'hide'}
#Setting working directory
setwd("~/PenguinProjectAssignment")

#Loading packages using libraries function
source("functions/libraries.R")

#Loading the raw data
penguins_raw <- read.csv("data_raw/penguins_raw.csv")

#Looking at the raw data
head(penguins_raw)

#Sourcing cleaning function to clean the raw data
source("functions/cleaning.R")

#Cleaning the raw data
penguins_clean <- cleaning(penguins_raw)

#Looking at the clean data
head(penguins_clean)

#Saving the clean data
write.csv(penguins_clean, "data_clean/penguins_clean_2.csv")

#Reading in the clean data
penguins_now_clean <- read.csv("data_clean/penguins_clean_2.csv")

#Sourcing function for removing NAs from flipper length column
source("functions/remove_NAs_from_flipper_length.R")

#Removing NAs from flipper length column
penguins_flipper_vs_body_mass <- remove_NAs_from_flipper_length(penguins_now_clean)

#Viewing new data frame
head(penguins_flipper_vs_body_mass)
```


```{r Question 4 Fitting linear model, echo = FALSE}
#Fitting a linear model to analyse the relationship between body mass and flipper length
LinearModel <- lm(flipper_length_mm ~ body_mass_g, penguins_flipper_vs_body_mass)

#Looking at the results of the linear model
summary(LinearModel)
```


```{r Question 4 Plotting figure, echo = FALSE, message = FALSE, warning = FALSE, results = 'hide'}
#Sourcing function for making a plot of the linear model
source("functions/plot_flipper_vs_body_mass_figure.R")

#Creating figure
LinearModelplot <- plot_flipper_vs_body_mass_figure(penguins_flipper_vs_body_mass)

#Viewing figure
LinearModelplot

#Sourcing function for saving figure
source("functions/save_plot_svg.R")

#Saving figure
save_plot_svg(penguins_flipper_vs_body_mass, 
                      "figures/fig01_vector.svg", 
                      size = 14, scaling = 0.93)
```
\newpage

## Bibliography
Baker, M. (2016) "1,500 scientists lift the lid on reproducibility". Nature. Available at: https://www.nature.com/articles/533452a (Accessed: 27 November 2022).

Crameri, F., Shephard, G. and Heron, P. (2020) "The misuse of colour in science communication", Nature Communications, 11(1). doi: 10.1038/s41467-020-19160-7.

Katsnelson, A. (2021) "Colour me better: fixing figures for colour blindness", Nature.com. Available at: https://www.nature.com/articles/d41586-021-02696-z (Accessed: 28 November 2022).

McKiernan, E. et al. (2016) "How open science helps researchers succeed", eLife, 5. doi: 10.7554/elife.16800.
